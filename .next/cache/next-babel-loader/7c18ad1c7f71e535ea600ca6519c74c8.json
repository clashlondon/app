{"ast":null,"code":"var _jsxFileName = \"/Users/mbp/Sites/london-clash-nextjs/components/WarPerformance.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState } from 'react';\n\nclass WarUser {\n  constructor({\n    name,\n    wins,\n    battlesPlayed,\n    cardsEarned,\n    numberOfBattles\n  }) {\n    this.name = name;\n    this.wins = wins;\n    this.battles = battlesPlayed;\n    this.totalBattles = numberOfBattles;\n    this.cards = cardsEarned;\n    this.isMember = true;\n    this.lossStreak = 0;\n    this.winStreak = 0;\n  }\n\n  addToKey(key, value) {\n    this[key] += value;\n  }\n\n  setMember(state) {\n    this.isMember = state;\n  }\n\n  recordLoss(losses) {\n    if (losses > 0) {\n      this.lossStreak += losses;\n    } else {}\n\n    this.lossStreak = losses > 0 ? this.lossStreak + losses : this.winStreak++;\n  }\n\n  get loss() {\n    return this.battles - this.wins;\n  }\n\n  get ratio() {\n    return this.wins / this.totalBattles;\n  }\n\n  get battlesMissed() {\n    return this.totalBattles - this.battles;\n  }\n\n  get inRespect() {\n    return this.ratio >= 0.75 || this.loss === 0 && this.missed === 0;\n  }\n\n  get inDanger() {\n    return this.ratio <= 0.25 || this.battlesMissed >= 3;\n  }\n\n  get score() {\n    if (this.battles === 0) return 0;\n    return (this.wins * (this.wins / this.battles) - this.battlesMissed * 2.5 * this.battlesMissed + this.wins * 0.5).toFixed(2);\n  }\n\n}\n\nconst processData = (items, clan) => {\n  let participants = [];\n\n  const findUser = name => participants.find(p => p.name === name);\n\n  items.forEach((war, i) => {\n    war.participants.forEach(user => {\n      var userObj = findUser(user.name);\n\n      if (!!userObj) {\n        userObj.addToKey('battles', user.battlesPlayed);\n        userObj.addToKey('wins', user.wins);\n        userObj.addToKey('cards', user.cardsEarned);\n        userObj.addToKey('totalBattles', user.numberOfBattles);\n      } else {\n        userObj = new WarUser(user);\n        participants.push(userObj);\n      }\n\n      userObj.setMember(clan.memberList.find(m => m.name === userObj.name));\n      let losses = user.numberOfBattles - user.wins;\n      userObj.winLoss(user.wins, losses);\n    });\n  });\n  return participants;\n};\n\nconst sortData = (items, key, alt) => {\n  return items.sort((a, b) => alt ? a[key] - b[key] : b[key] - a[key]);\n};\n\nconst WarPerformance = props => {\n  console.log(props.items);\n  const {\n    0: sort,\n    1: setSort\n  } = useState('score');\n  const {\n    0: alt,\n    1: setAlt\n  } = useState(false);\n  const {\n    0: data,\n    1: setData\n  } = useState(processData(props.items, props.clan));\n  const sortedData = sortData(data, sort, alt);\n\n  const clickSort = newSort => {\n    if (newSort === sort) {\n      setAlt(!alt);\n    } else {\n      setSort(newSort);\n    }\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"jsx-1736245729\" + \" \" + \"table-responsive\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, __jsx(\"table\", {\n    className: \"jsx-1736245729\" + \" \" + 'table table-sm',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, __jsx(\"thead\", {\n    className: \"jsx-1736245729\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, __jsx(\"tr\", {\n    className: \"jsx-1736245729\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, __jsx(\"th\", {\n    className: \"jsx-1736245729\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, \"Name\"), __jsx(\"th\", {\n    onClick: () => clickSort('score'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'score' ? 'active' : null) || \"\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }, \"Score\"), __jsx(\"th\", {\n    onClick: () => clickSort('totalBattles'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'totalBattles' ? 'active' : null) || \"\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }, \"Total Battles\"), __jsx(\"th\", {\n    onClick: () => clickSort('wins'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'wins' ? 'active' : null) || \"\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }, \"Wins\"), __jsx(\"th\", {\n    onClick: () => clickSort('loss'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'loss' ? 'active' : null) || \"\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, \"Losses\"), __jsx(\"th\", {\n    onClick: () => clickSort('lossStreak'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'lossStreak' ? 'active' : null) || \"\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, \"lossStreak\"), __jsx(\"th\", {\n    onClick: () => clickSort('ratio'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'ratio' ? 'active' : null) || \"\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, \"Win Ratio\", __jsx(\"span\", {\n    className: \"jsx-1736245729\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, \"wins/battles\")), __jsx(\"th\", {\n    onClick: () => clickSort('battlesMissed'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'battlesMissed' ? 'active' : null) || \"\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, \"Battles Missed\"))), __jsx(\"tbody\", {\n    className: \"jsx-1736245729\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, sortedData.map((p, i) => {\n    let className = p.score < -1 ? 'bg-danger' : p.score <= 1 ? 'table-danger' : p.score >= 8 ? 'table-warning' : 'table-success';\n    className += p.isMember ? ' member' : '';\n    return __jsx(\"tr\", {\n      key: i,\n      className: \"jsx-1736245729\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, __jsx(\"td\", {\n      className: \"jsx-1736245729\" + \" \" + (className || \"\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, p.name), __jsx(\"td\", {\n      className: \"jsx-1736245729\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, p.score), __jsx(\"td\", {\n      className: \"jsx-1736245729\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, p.totalBattles), __jsx(\"td\", {\n      className: \"jsx-1736245729\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, p.wins), __jsx(\"td\", {\n      className: \"jsx-1736245729\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, p.loss), __jsx(\"td\", {\n      className: \"jsx-1736245729\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, p.lossStreak), __jsx(\"td\", {\n      className: \"jsx-1736245729\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, p.ratio.toFixed(2)), __jsx(\"td\", {\n      className: \"jsx-1736245729\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, p.battlesMissed));\n  })))), __jsx(_JSXStyle, {\n    id: \"1736245729\",\n    __self: this\n  }, \".table-responsive.jsx-1736245729{overflow-x:initial;}.table.jsx-1736245729{width:100%;}.table.jsx-1736245729 thead.jsx-1736245729{font-weight:bold;}.table.jsx-1736245729 thead.jsx-1736245729 th.jsx-1736245729{cursor:pointer;position:-webkit-sticky;position:sticky;top:0;background:white;min-width:8rem;}.table.jsx-1736245729 thead.jsx-1736245729 th.jsx-1736245729 span.jsx-1736245729{display:block;font-size:0.5rem;}.table.jsx-1736245729 thead.jsx-1736245729 th.active.jsx-1736245729{color:blue;}table.jsx-1736245729 tbody.jsx-1736245729 td.jsx-1736245729:first-child.jsx-1736245729:not(.member){-webkit-text-decoration:line-through;text-decoration:line-through;font-weight:bold;background-color:grey !important;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYnAvU2l0ZXMvbG9uZG9uLWNsYXNoLW5leHRqcy9jb21wb25lbnRzL1dhclBlcmZvcm1hbmNlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQXlJa0IsQUFHOEIsQUFHUixBQUdNLEFBR0YsQUFPRCxBQUlILEFBR2tCLFdBbkIvQixBQWlCQSxHQUptQixDQVBELEVBSGxCLEVBTkEsWUFpQkEsd0JBUFEsTUFDVyxLQVlBLFlBWEYsS0FZa0IsVUFYbkMsdUJBWUEiLCJmaWxlIjoiL1VzZXJzL21icC9TaXRlcy9sb25kb24tY2xhc2gtbmV4dGpzL2NvbXBvbmVudHMvV2FyUGVyZm9ybWFuY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0J1xuXG5jbGFzcyBXYXJVc2VyIHtcbiAgY29uc3RydWN0b3Ioe25hbWUsIHdpbnMsIGJhdHRsZXNQbGF5ZWQsIGNhcmRzRWFybmVkLCBudW1iZXJPZkJhdHRsZXN9KSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZVxuICAgIHRoaXMud2lucyA9IHdpbnNcbiAgICB0aGlzLmJhdHRsZXMgPSBiYXR0bGVzUGxheWVkXG4gICAgdGhpcy50b3RhbEJhdHRsZXMgPSBudW1iZXJPZkJhdHRsZXNcbiAgICB0aGlzLmNhcmRzID0gY2FyZHNFYXJuZWRcbiAgICB0aGlzLmlzTWVtYmVyID0gdHJ1ZVxuICAgIHRoaXMubG9zc1N0cmVhayA9IDBcbiAgICB0aGlzLndpblN0cmVhayA9IDBcbiAgfVxuXG4gIGFkZFRvS2V5KGtleSwgdmFsdWUpIHtcbiAgICB0aGlzW2tleV0gKz0gdmFsdWVcbiAgfVxuXG4gIHNldE1lbWJlcihzdGF0ZSkge1xuICAgIHRoaXMuaXNNZW1iZXIgPSBzdGF0ZVxuICB9XG5cbiAgcmVjb3JkTG9zcyhsb3NzZXMpIHtcbiAgICBpZiAobG9zc2VzID4gMCkge1xuICAgICAgdGhpcy5sb3NzU3RyZWFrICs9IGxvc3Nlc1xuICAgIH0gZWxzZSB7XG5cbiAgICB9XG4gICAgdGhpcy5sb3NzU3RyZWFrID0gbG9zc2VzID4gMCA/IHRoaXMubG9zc1N0cmVhayArIGxvc3NlcyA6IHRoaXMud2luU3RyZWFrKytcbiAgfVxuXG4gIGdldCBsb3NzKCkge1xuICAgIHJldHVybiB0aGlzLmJhdHRsZXMgLSB0aGlzLndpbnNcbiAgfVxuXG4gIGdldCByYXRpbygpIHtcbiAgICByZXR1cm4gdGhpcy53aW5zIC8gdGhpcy50b3RhbEJhdHRsZXNcbiAgfVxuXG4gIGdldCBiYXR0bGVzTWlzc2VkKCkge1xuICAgIHJldHVybiB0aGlzLnRvdGFsQmF0dGxlcyAtIHRoaXMuYmF0dGxlc1xuICB9XG5cbiAgZ2V0IGluUmVzcGVjdCgpIHtcbiAgICByZXR1cm4gdGhpcy5yYXRpbyA+PSAwLjc1IHx8IHRoaXMubG9zcyA9PT0gMCAmJiB0aGlzLm1pc3NlZCA9PT0gMFxuICB9XG5cbiAgZ2V0IGluRGFuZ2VyKCkge1xuICAgIHJldHVybiB0aGlzLnJhdGlvIDw9IDAuMjUgfHwgdGhpcy5iYXR0bGVzTWlzc2VkID49IDNcbiAgfVxuXG4gIGdldCBzY29yZSgpIHtcbiAgICBpZiAodGhpcy5iYXR0bGVzID09PSAwKSByZXR1cm4gMFxuICAgIHJldHVybiAodGhpcy53aW5zICogKHRoaXMud2lucyAvIHRoaXMuYmF0dGxlcykgLSAoKHRoaXMuYmF0dGxlc01pc3NlZCAqIDIuNSkgKiB0aGlzLmJhdHRsZXNNaXNzZWQpICsgKHRoaXMud2lucyAqIDAuNSkpLnRvRml4ZWQoMilcbiAgfVxufVxuXG5jb25zdCBwcm9jZXNzRGF0YSA9IChpdGVtcywgY2xhbikgPT4ge1xuICBsZXQgcGFydGljaXBhbnRzID0gW11cbiAgY29uc3QgZmluZFVzZXIgPSAobmFtZSkgPT4gcGFydGljaXBhbnRzLmZpbmQoKHApID0+IHAubmFtZSA9PT0gbmFtZSk7XG4gIGl0ZW1zLmZvckVhY2goKHdhciwgaSkgPT4ge1xuICAgICAgd2FyLnBhcnRpY2lwYW50cy5mb3JFYWNoKCh1c2VyKSA9PiB7XG4gICAgICAgICAgdmFyIHVzZXJPYmogPSBmaW5kVXNlcih1c2VyLm5hbWUpXG4gICAgICAgICAgaWYgKCEhdXNlck9iaikge1xuICAgICAgICAgICAgICB1c2VyT2JqLmFkZFRvS2V5KCdiYXR0bGVzJywgdXNlci5iYXR0bGVzUGxheWVkKVxuICAgICAgICAgICAgICB1c2VyT2JqLmFkZFRvS2V5KCd3aW5zJywgdXNlci53aW5zKVxuICAgICAgICAgICAgICB1c2VyT2JqLmFkZFRvS2V5KCdjYXJkcycsIHVzZXIuY2FyZHNFYXJuZWQpXG4gICAgICAgICAgICAgIHVzZXJPYmouYWRkVG9LZXkoJ3RvdGFsQmF0dGxlcycsIHVzZXIubnVtYmVyT2ZCYXR0bGVzKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHVzZXJPYmogPSBuZXcgV2FyVXNlcih1c2VyKVxuICAgICAgICAgICAgICBwYXJ0aWNpcGFudHMucHVzaCh1c2VyT2JqKVxuICAgICAgICAgIH1cbiAgICAgICAgICB1c2VyT2JqLnNldE1lbWJlcihjbGFuLm1lbWJlckxpc3QuZmluZChtID0+IG0ubmFtZSA9PT0gdXNlck9iai5uYW1lKSlcblxuICAgICAgICAgIGxldCBsb3NzZXMgPSB1c2VyLm51bWJlck9mQmF0dGxlcyAtIHVzZXIud2luc1xuICAgICAgICAgIHVzZXJPYmoud2luTG9zcyh1c2VyLndpbnMsIGxvc3NlcylcbiAgICAgIH0pXG4gIH0pXG4gIHJldHVybiBwYXJ0aWNpcGFudHNcbn1cblxuY29uc3Qgc29ydERhdGEgPSAoaXRlbXMsIGtleSwgYWx0KSA9PiB7XG4gIHJldHVybiBpdGVtcy5zb3J0KChhLCBiKSA9PiBhbHQgPyBhW2tleV0gLSBiW2tleV0gOiBiW2tleV0gLSBhW2tleV0pXG59XG5cbmNvbnN0IFdhclBlcmZvcm1hbmNlID0gKHByb3BzKSA9PiB7XG4gIGNvbnNvbGUubG9nKHByb3BzLml0ZW1zKVxuICBjb25zdCBbc29ydCwgc2V0U29ydF0gPSB1c2VTdGF0ZSgnc2NvcmUnKVxuICBjb25zdCBbYWx0LCBzZXRBbHRdID0gdXNlU3RhdGUoZmFsc2UpXG4gIGNvbnN0IFtkYXRhLCBzZXREYXRhXSA9IHVzZVN0YXRlKHByb2Nlc3NEYXRhKHByb3BzLml0ZW1zLCBwcm9wcy5jbGFuKSlcblxuICBjb25zdCBzb3J0ZWREYXRhID0gc29ydERhdGEoZGF0YSwgc29ydCwgYWx0KVxuXG4gIGNvbnN0IGNsaWNrU29ydCA9IChuZXdTb3J0KSA9PiB7XG4gICAgaWYgKG5ld1NvcnQgPT09IHNvcnQpIHtcbiAgICAgIHNldEFsdCghYWx0KVxuICAgIH0gZWxzZSB7XG4gICAgICBzZXRTb3J0KG5ld1NvcnQpXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YWJsZS1yZXNwb25zaXZlXCI+XG4gICAgICAgIDx0YWJsZSBjbGFzc05hbWU9eyd0YWJsZSB0YWJsZS1zbSd9PlxuICAgICAgICAgIDx0aGVhZD5cbiAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgPHRoPk5hbWU8L3RoPlxuICAgICAgICAgICAgICA8dGggY2xhc3NOYW1lPXtzb3J0ID09PSAnc2NvcmUnID8gJ2FjdGl2ZScgOiBudWxsfSBvbkNsaWNrPXsoKCkgPT4gY2xpY2tTb3J0KCdzY29yZScpKX0+U2NvcmU8L3RoPlxuICAgICAgICAgICAgICA8dGggY2xhc3NOYW1lPXtzb3J0ID09PSAndG90YWxCYXR0bGVzJyA/ICdhY3RpdmUnIDogbnVsbH0gb25DbGljaz17KCgpID0+IGNsaWNrU29ydCgndG90YWxCYXR0bGVzJykpfT5Ub3RhbCBCYXR0bGVzPC90aD5cbiAgICAgICAgICAgICAgPHRoIGNsYXNzTmFtZT17c29ydCA9PT0gJ3dpbnMnID8gJ2FjdGl2ZScgOiBudWxsfSBvbkNsaWNrPXsoKCkgPT4gY2xpY2tTb3J0KCd3aW5zJykpfT5XaW5zPC90aD5cbiAgICAgICAgICAgICAgPHRoIGNsYXNzTmFtZT17c29ydCA9PT0gJ2xvc3MnID8gJ2FjdGl2ZScgOiBudWxsfSBvbkNsaWNrPXsoKCkgPT4gY2xpY2tTb3J0KCdsb3NzJykpfT5Mb3NzZXM8L3RoPlxuICAgICAgICAgICAgICA8dGggY2xhc3NOYW1lPXtzb3J0ID09PSAnbG9zc1N0cmVhaycgPyAnYWN0aXZlJyA6IG51bGx9IG9uQ2xpY2s9eygoKSA9PiBjbGlja1NvcnQoJ2xvc3NTdHJlYWsnKSl9Pmxvc3NTdHJlYWs8L3RoPlxuICAgICAgICAgICAgICA8dGggY2xhc3NOYW1lPXtzb3J0ID09PSAncmF0aW8nID8gJ2FjdGl2ZScgOiBudWxsfSBvbkNsaWNrPXsoKCkgPT4gY2xpY2tTb3J0KCdyYXRpbycpKX0+V2luIFJhdGlvPHNwYW4+d2lucy9iYXR0bGVzPC9zcGFuPjwvdGg+XG4gICAgICAgICAgICAgIDx0aCBjbGFzc05hbWU9e3NvcnQgPT09ICdiYXR0bGVzTWlzc2VkJyA/ICdhY3RpdmUnIDogbnVsbH0gb25DbGljaz17KCgpID0+IGNsaWNrU29ydCgnYmF0dGxlc01pc3NlZCcpKX0+QmF0dGxlcyBNaXNzZWQ8L3RoPlxuICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICA8L3RoZWFkPlxuICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgIHtzb3J0ZWREYXRhLm1hcCgocCwgaSkgPT4ge1xuICAgICAgICAgICAgICBsZXQgY2xhc3NOYW1lID0gcC5zY29yZSA8IC0xID8gJ2JnLWRhbmdlcicgOiBwLnNjb3JlIDw9IDEgPyAndGFibGUtZGFuZ2VyJyA6IHAuc2NvcmUgPj0gOCA/ICd0YWJsZS13YXJuaW5nJyA6ICd0YWJsZS1zdWNjZXNzJ1xuICAgICAgICAgICAgICBjbGFzc05hbWUgKz0gcC5pc01lbWJlciA/ICcgbWVtYmVyJyA6ICcnXG4gICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPHRyIGtleT17aX0+XG4gICAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPXtjbGFzc05hbWV9PntwLm5hbWV9PC90ZD5cbiAgICAgICAgICAgICAgICAgIDx0ZD57cC5zY29yZX08L3RkPlxuICAgICAgICAgICAgICAgICAgPHRkPntwLnRvdGFsQmF0dGxlc308L3RkPlxuICAgICAgICAgICAgICAgICAgPHRkPntwLndpbnN9PC90ZD5cbiAgICAgICAgICAgICAgICAgIDx0ZD57cC5sb3NzfTwvdGQ+XG4gICAgICAgICAgICAgICAgICA8dGQ+e3AubG9zc1N0cmVha308L3RkPlxuICAgICAgICAgICAgICAgICAgPHRkPntwLnJhdGlvLnRvRml4ZWQoMil9PC90ZD5cbiAgICAgICAgICAgICAgICAgIDx0ZD57cC5iYXR0bGVzTWlzc2VkfTwvdGQ+XG4gICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfSl9XG4gICAgICAgICAgPC90Ym9keT5cbiAgICAgICAgPC90YWJsZT5cbiAgICAgIDwvZGl2PlxuICAgICAgPHN0eWxlIGpzeD57YFxuICAgICAgICAudGFibGUtcmVzcG9uc2l2ZSB7XG4gICAgICAgICAgb3ZlcmZsb3cteDogaW5pdGlhbDtcbiAgICAgICAgfVxuICAgICAgICAudGFibGUge1xuICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICB9XG4gICAgICAgIC50YWJsZSB0aGVhZCB7XG4gICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7XG4gICAgICAgIH1cbiAgICAgICAgLnRhYmxlIHRoZWFkIHRoIHtcbiAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgcG9zaXRpb246IHN0aWNreTtcbiAgICAgICAgICB0b3A6IDA7XG4gICAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7XG4gICAgICAgICAgbWluLXdpZHRoOiA4cmVtO1xuICAgICAgICB9XG4gICAgICAgIC50YWJsZSB0aGVhZCB0aCBzcGFuIHtcbiAgICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgICAgICBmb250LXNpemU6IDAuNXJlbTtcbiAgICAgICAgfVxuICAgICAgICAudGFibGUgdGhlYWQgdGguYWN0aXZlIHtcbiAgICAgICAgICBjb2xvcjogYmx1ZTtcbiAgICAgICAgfVxuICAgICAgICB0YWJsZSB0Ym9keSB0ZDpmaXJzdC1jaGlsZDpub3QoLm1lbWJlcikge1xuICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogbGluZS10aHJvdWdoO1xuICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xuICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IGdyZXkgIWltcG9ydGFudDtcbiAgICAgICAgfVxuICAgICAgICBgfVxuICAgICAgPC9zdHlsZT5cbiAgICA8Lz5cbiAgKVxufVxuXG5leHBvcnQgZGVmYXVsdCBXYXJQZXJmb3JtYW5jZTtcbiJdfQ== */\\n/*@ sourceURL=/Users/mbp/Sites/london-clash-nextjs/components/WarPerformance.js */\"));\n};\n\nexport default WarPerformance;","map":{"version":3,"sources":["/Users/mbp/Sites/london-clash-nextjs/components/WarPerformance.js"],"names":["useState","WarUser","constructor","name","wins","battlesPlayed","cardsEarned","numberOfBattles","battles","totalBattles","cards","isMember","lossStreak","winStreak","addToKey","key","value","setMember","state","recordLoss","losses","loss","ratio","battlesMissed","inRespect","missed","inDanger","score","toFixed","processData","items","clan","participants","findUser","find","p","forEach","war","i","user","userObj","push","memberList","m","winLoss","sortData","alt","sort","a","b","WarPerformance","props","console","log","setSort","setAlt","data","setData","sortedData","clickSort","newSort","map","className"],"mappings":"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","sourcesContent":["import { useState } from 'react'\n\nclass WarUser {\n  constructor({name, wins, battlesPlayed, cardsEarned, numberOfBattles}) {\n    this.name = name\n    this.wins = wins\n    this.battles = battlesPlayed\n    this.totalBattles = numberOfBattles\n    this.cards = cardsEarned\n    this.isMember = true\n    this.lossStreak = 0\n    this.winStreak = 0\n  }\n\n  addToKey(key, value) {\n    this[key] += value\n  }\n\n  setMember(state) {\n    this.isMember = state\n  }\n\n  recordLoss(losses) {\n    if (losses > 0) {\n      this.lossStreak += losses\n    } else {\n\n    }\n    this.lossStreak = losses > 0 ? this.lossStreak + losses : this.winStreak++\n  }\n\n  get loss() {\n    return this.battles - this.wins\n  }\n\n  get ratio() {\n    return this.wins / this.totalBattles\n  }\n\n  get battlesMissed() {\n    return this.totalBattles - this.battles\n  }\n\n  get inRespect() {\n    return this.ratio >= 0.75 || this.loss === 0 && this.missed === 0\n  }\n\n  get inDanger() {\n    return this.ratio <= 0.25 || this.battlesMissed >= 3\n  }\n\n  get score() {\n    if (this.battles === 0) return 0\n    return (this.wins * (this.wins / this.battles) - ((this.battlesMissed * 2.5) * this.battlesMissed) + (this.wins * 0.5)).toFixed(2)\n  }\n}\n\nconst processData = (items, clan) => {\n  let participants = []\n  const findUser = (name) => participants.find((p) => p.name === name);\n  items.forEach((war, i) => {\n      war.participants.forEach((user) => {\n          var userObj = findUser(user.name)\n          if (!!userObj) {\n              userObj.addToKey('battles', user.battlesPlayed)\n              userObj.addToKey('wins', user.wins)\n              userObj.addToKey('cards', user.cardsEarned)\n              userObj.addToKey('totalBattles', user.numberOfBattles)\n          } else {\n              userObj = new WarUser(user)\n              participants.push(userObj)\n          }\n          userObj.setMember(clan.memberList.find(m => m.name === userObj.name))\n\n          let losses = user.numberOfBattles - user.wins\n          userObj.winLoss(user.wins, losses)\n      })\n  })\n  return participants\n}\n\nconst sortData = (items, key, alt) => {\n  return items.sort((a, b) => alt ? a[key] - b[key] : b[key] - a[key])\n}\n\nconst WarPerformance = (props) => {\n  console.log(props.items)\n  const [sort, setSort] = useState('score')\n  const [alt, setAlt] = useState(false)\n  const [data, setData] = useState(processData(props.items, props.clan))\n\n  const sortedData = sortData(data, sort, alt)\n\n  const clickSort = (newSort) => {\n    if (newSort === sort) {\n      setAlt(!alt)\n    } else {\n      setSort(newSort)\n    }\n  }\n\n  return (\n    <>\n      <div className=\"table-responsive\">\n        <table className={'table table-sm'}>\n          <thead>\n            <tr>\n              <th>Name</th>\n              <th className={sort === 'score' ? 'active' : null} onClick={(() => clickSort('score'))}>Score</th>\n              <th className={sort === 'totalBattles' ? 'active' : null} onClick={(() => clickSort('totalBattles'))}>Total Battles</th>\n              <th className={sort === 'wins' ? 'active' : null} onClick={(() => clickSort('wins'))}>Wins</th>\n              <th className={sort === 'loss' ? 'active' : null} onClick={(() => clickSort('loss'))}>Losses</th>\n              <th className={sort === 'lossStreak' ? 'active' : null} onClick={(() => clickSort('lossStreak'))}>lossStreak</th>\n              <th className={sort === 'ratio' ? 'active' : null} onClick={(() => clickSort('ratio'))}>Win Ratio<span>wins/battles</span></th>\n              <th className={sort === 'battlesMissed' ? 'active' : null} onClick={(() => clickSort('battlesMissed'))}>Battles Missed</th>\n            </tr>\n          </thead>\n          <tbody>\n            {sortedData.map((p, i) => {\n              let className = p.score < -1 ? 'bg-danger' : p.score <= 1 ? 'table-danger' : p.score >= 8 ? 'table-warning' : 'table-success'\n              className += p.isMember ? ' member' : ''\n              return (\n                <tr key={i}>\n                  <td className={className}>{p.name}</td>\n                  <td>{p.score}</td>\n                  <td>{p.totalBattles}</td>\n                  <td>{p.wins}</td>\n                  <td>{p.loss}</td>\n                  <td>{p.lossStreak}</td>\n                  <td>{p.ratio.toFixed(2)}</td>\n                  <td>{p.battlesMissed}</td>\n                </tr>\n              )\n            })}\n          </tbody>\n        </table>\n      </div>\n      <style jsx>{`\n        .table-responsive {\n          overflow-x: initial;\n        }\n        .table {\n          width: 100%;\n        }\n        .table thead {\n          font-weight: bold;\n        }\n        .table thead th {\n          cursor: pointer;\n          position: sticky;\n          top: 0;\n          background: white;\n          min-width: 8rem;\n        }\n        .table thead th span {\n          display: block;\n          font-size: 0.5rem;\n        }\n        .table thead th.active {\n          color: blue;\n        }\n        table tbody td:first-child:not(.member) {\n          text-decoration: line-through;\n          font-weight: bold;\n          background-color: grey !important;\n        }\n        `}\n      </style>\n    </>\n  )\n}\n\nexport default WarPerformance;\n"]},"metadata":{},"sourceType":"module"}