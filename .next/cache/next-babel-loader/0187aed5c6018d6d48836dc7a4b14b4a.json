{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState } from 'react';\n\nclass WarUser {\n  constructor({\n    name,\n    wins,\n    battlesPlayed,\n    cardsEarned,\n    numberOfBattles\n  }) {\n    this.name = name;\n    this.wins = wins;\n    this.battles = battlesPlayed;\n    this.totalBattles = numberOfBattles;\n    this.cards = cardsEarned;\n  }\n\n  addToKey(key, value) {\n    this[key] += value;\n  }\n\n  get loss() {\n    return this.battles - this.wins;\n  }\n\n  get ratio() {\n    return this.wins / this.totalBattles;\n  }\n\n  get battlesMissed() {\n    return this.totalBattles - this.battles;\n  }\n\n  get inRespect() {\n    return this.ratio >= 0.75 || this.loss === 0 && this.missed === 0;\n  }\n\n  get inDanger() {\n    return this.ratio <= 0.25 || this.battlesMissed >= 3;\n  }\n\n  get score() {\n    return (this.wins * (this.wins / this.battles) - this.battlesMissed * 2.5 * this.battlesMissed + this.wins * 0.5).toFixed(2);\n  }\n\n}\n\nconst processData = items => {\n  let participants = [];\n\n  const findUser = name => participants.find(p => p.name === name);\n\n  items.forEach((war, i) => {\n    war.participants.forEach(user => {\n      var userObj = findUser(user.name);\n\n      if (!!userObj) {\n        userObj.addToKey('battles', user.battlesPlayed);\n        userObj.addToKey('wins', user.wins);\n        userObj.addToKey('cards', user.cardsEarned);\n        userObj.addToKey('totalBattles', user.numberOfBattles);\n      } else {\n        userObj = new WarUser(user);\n        participants.push(userObj);\n      }\n    });\n  });\n  return participants;\n};\n\nconst sortData = (items, key, alt) => {\n  return items.sort((a, b) => alt ? a[key] - b[key] : b[key] - a[key]);\n};\n\nconst WarPerformance = props => {\n  const {\n    0: sort,\n    1: setSort\n  } = useState('score');\n  const {\n    0: alt,\n    1: setAlt\n  } = useState(false);\n  const {\n    0: data,\n    1: setData\n  } = useState(processData(props.items));\n  const sortedData = sortData(data, sort, alt);\n\n  const clickSort = newSort => {\n    if (newSort === sort) {\n      setAlt(!alt);\n    } else {\n      setSort(newSort);\n    }\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"header\", {\n    className: \"jsx-309811624\" + \" \" + \"p-4\"\n  }, __jsx(\"h1\", {\n    className: \"jsx-309811624\"\n  }, \"ClashLondon\")), __jsx(\"div\", {\n    className: \"jsx-309811624\" + \" \" + \"table-responsive\"\n  }, __jsx(\"table\", {\n    className: \"jsx-309811624\" + \" \" + 'table table-sm'\n  }, __jsx(\"thead\", {\n    className: \"jsx-309811624\"\n  }, __jsx(\"tr\", {\n    className: \"jsx-309811624\"\n  }, __jsx(\"th\", {\n    className: \"jsx-309811624\"\n  }, \"Name\"), __jsx(\"th\", {\n    onClick: () => clickSort('score'),\n    className: \"jsx-309811624\" + \" \" + ((sort === 'score' ? 'active' : null) || \"\")\n  }, \"Score\"), __jsx(\"th\", {\n    onClick: () => clickSort('totalBattles'),\n    className: \"jsx-309811624\" + \" \" + ((sort === 'totalBattles' ? 'active' : null) || \"\")\n  }, \"Total Battles\"), __jsx(\"th\", {\n    onClick: () => clickSort('wins'),\n    className: \"jsx-309811624\" + \" \" + ((sort === 'wins' ? 'active' : null) || \"\")\n  }, \"Wins\"), __jsx(\"th\", {\n    onClick: () => clickSort('loss'),\n    className: \"jsx-309811624\" + \" \" + ((sort === 'loss' ? 'active' : null) || \"\")\n  }, \"Losses\"), __jsx(\"th\", {\n    onClick: () => clickSort('ratio'),\n    className: \"jsx-309811624\" + \" \" + ((sort === 'ratio' ? 'active' : null) || \"\")\n  }, \"Win Ratio\", __jsx(\"span\", {\n    className: \"jsx-309811624\"\n  }, \"wins/battles\")), __jsx(\"th\", {\n    onClick: () => clickSort('battlesMissed'),\n    className: \"jsx-309811624\" + \" \" + ((sort === 'battlesMissed' ? 'active' : null) || \"\")\n  }, \"Battles Missed\"))), __jsx(\"tbody\", {\n    className: \"jsx-309811624\"\n  }, sortedData.map((p, i) => {\n    let className = p.score < -1 ? 'bg-danger' : p.score <= 1 ? 'table-danger' : p.score >= 8 ? 'table-warning' : 'table-success';\n    return __jsx(\"tr\", {\n      key: i,\n      className: \"jsx-309811624\"\n    }, __jsx(\"td\", {\n      className: \"jsx-309811624\" + \" \" + (className || \"\")\n    }, p.name), __jsx(\"td\", {\n      className: \"jsx-309811624\"\n    }, p.score), __jsx(\"td\", {\n      className: \"jsx-309811624\"\n    }, p.totalBattles), __jsx(\"td\", {\n      className: \"jsx-309811624\"\n    }, p.wins), __jsx(\"td\", {\n      className: \"jsx-309811624\"\n    }, p.loss), __jsx(\"td\", {\n      className: \"jsx-309811624\"\n    }, p.ratio.toFixed(2)), __jsx(\"td\", {\n      className: \"jsx-309811624\"\n    }, p.battlesMissed));\n  })))), __jsx(_JSXStyle, {\n    id: \"309811624\"\n  }, [\".table-responsive.jsx-309811624{overflow-x:initial;}\", \".table.jsx-309811624{width:100%;}\", \".table.jsx-309811624 thead.jsx-309811624{font-weight:bold;}\", \".table.jsx-309811624 thead.jsx-309811624 th.jsx-309811624{cursor:pointer;position:-webkit-sticky;position:sticky;top:0;background:white;min-width:8rem;}\", \".table.jsx-309811624 thead.jsx-309811624 th.jsx-309811624 span.jsx-309811624{display:block;font-size:0.5rem;}\", \".table.jsx-309811624 thead.jsx-309811624 th.active.jsx-309811624{color:blue;}\"]));\n};\n\nexport default WarPerformance;","map":null,"metadata":{},"sourceType":"module"}