{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState } from 'react';\n\nclass WarUser {\n  constructor({\n    name,\n    wins,\n    battlesPlayed,\n    cardsEarned,\n    numberOfBattles\n  }) {\n    this.name = name;\n    this.wins = wins;\n    this.battles = battlesPlayed;\n    this.totalBattles = numberOfBattles;\n    this.cards = cardsEarned;\n    this.isMember = true;\n    this.lossStreak = 0;\n    this.winStreak = 0;\n  }\n\n  addToKey(key, value) {\n    this[key] += value;\n  }\n\n  setMember(state) {\n    this.isMember = state;\n  }\n\n  winLoss(wins, losses) {\n    if (losses > 0 && wins === 0) {\n      this.lossStreak += losses;\n      this.winStreak = 0;\n    }\n\n    if (wins > 0) {\n      this.winStreak += wins;\n      this.lossStreak = 0;\n    }\n  }\n\n  get loss() {\n    return this.battles - this.wins;\n  }\n\n  get ratio() {\n    return this.wins / this.totalBattles;\n  }\n\n  get battlesMissed() {\n    return this.totalBattles - this.battles;\n  }\n\n  get inRespect() {\n    return this.ratio >= 0.75 || this.loss === 0 && this.missed === 0;\n  }\n\n  get inDanger() {\n    return this.ratio <= 0.25 || this.battlesMissed >= 3;\n  }\n\n  get score() {\n    if (this.battles === 0) return 0;\n    return (this.wins * (this.wins / this.battles) - this.battlesMissed * 2.5 * this.battlesMissed + this.wins * 0.5).toFixed(2);\n  }\n\n}\n\nconst processData = (items, clan) => {\n  let participants = [];\n\n  const findUser = name => participants.find(p => p.name === name);\n\n  items.forEach((war, i) => {\n    war.participants.forEach(user => {\n      var userObj = findUser(user.name);\n\n      if (!!userObj) {\n        userObj.addToKey('battles', user.battlesPlayed);\n        userObj.addToKey('wins', user.wins);\n        userObj.addToKey('cards', user.cardsEarned);\n        userObj.addToKey('totalBattles', user.numberOfBattles);\n      } else {\n        userObj = new WarUser(user);\n        participants.push(userObj);\n      } // set is member\n\n\n      userObj.setMember(clan.memberList.find(m => m.name === userObj.name)); // record wins losses per war\n\n      let losses = user.numberOfBattles - user.wins;\n      userObj.winLoss(user.wins, losses);\n    });\n  });\n  return participants;\n};\n\nconst sortData = (items, key, alt) => {\n  return items.sort((a, b) => alt ? a[key] - b[key] : b[key] - a[key]);\n};\n\nconst WarPerformance = props => {\n  const {\n    0: sort,\n    1: setSort\n  } = useState('score');\n  const {\n    0: alt,\n    1: setAlt\n  } = useState(false);\n  const {\n    0: data,\n    1: setData\n  } = useState(processData(props.items, props.clan));\n  const sortedData = sortData(data, sort, alt);\n\n  const clickSort = newSort => {\n    if (newSort === sort) {\n      setAlt(!alt);\n    } else {\n      setSort(newSort);\n    }\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"jsx-1736245729\" + \" \" + \"table-responsive\"\n  }, __jsx(\"table\", {\n    className: \"jsx-1736245729\" + \" \" + 'table table-sm'\n  }, __jsx(\"thead\", {\n    className: \"jsx-1736245729\"\n  }, __jsx(\"tr\", {\n    className: \"jsx-1736245729\"\n  }, __jsx(\"th\", {\n    className: \"jsx-1736245729\"\n  }, \"Name\"), __jsx(\"th\", {\n    onClick: () => clickSort('score'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'score' ? 'active' : null) || \"\")\n  }, \"Score\"), __jsx(\"th\", {\n    onClick: () => clickSort('totalBattles'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'totalBattles' ? 'active' : null) || \"\")\n  }, \"Total Battles\"), __jsx(\"th\", {\n    onClick: () => clickSort('wins'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'wins' ? 'active' : null) || \"\")\n  }, \"Wins\"), __jsx(\"th\", {\n    onClick: () => clickSort('loss'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'loss' ? 'active' : null) || \"\")\n  }, \"Losses\"), __jsx(\"th\", {\n    onClick: () => clickSort('winStreak'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'winStreak' ? 'active' : null) || \"\")\n  }, \"Win Streak\"), __jsx(\"th\", {\n    onClick: () => clickSort('lossStreak'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'lossStreak' ? 'active' : null) || \"\")\n  }, \"Loss Streak\"), __jsx(\"th\", {\n    onClick: () => clickSort('ratio'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'ratio' ? 'active' : null) || \"\")\n  }, \"Win Ratio\", __jsx(\"span\", {\n    className: \"jsx-1736245729\"\n  }, \"wins/battles\")), __jsx(\"th\", {\n    onClick: () => clickSort('battlesMissed'),\n    className: \"jsx-1736245729\" + \" \" + ((sort === 'battlesMissed' ? 'active' : null) || \"\")\n  }, \"Battles Missed\"))), __jsx(\"tbody\", {\n    className: \"jsx-1736245729\"\n  }, sortedData.map((p, i) => {\n    let className = p.score < -1 ? 'bg-danger' : p.score <= 1 ? 'table-danger' : p.score >= 8 ? 'table-warning' : 'table-success';\n    className += p.isMember ? ' member' : '';\n    return __jsx(\"tr\", {\n      key: i,\n      className: \"jsx-1736245729\"\n    }, __jsx(\"td\", {\n      className: \"jsx-1736245729\" + \" \" + (className || \"\")\n    }, p.name), __jsx(\"td\", {\n      className: \"jsx-1736245729\"\n    }, p.score), __jsx(\"td\", {\n      className: \"jsx-1736245729\"\n    }, p.totalBattles), __jsx(\"td\", {\n      className: \"jsx-1736245729\"\n    }, p.wins), __jsx(\"td\", {\n      className: \"jsx-1736245729\"\n    }, p.loss), __jsx(\"td\", {\n      className: \"jsx-1736245729\"\n    }, p.winStreak), __jsx(\"td\", {\n      className: \"jsx-1736245729\"\n    }, p.lossStreak), __jsx(\"td\", {\n      className: \"jsx-1736245729\"\n    }, p.ratio.toFixed(2)), __jsx(\"td\", {\n      className: \"jsx-1736245729\"\n    }, p.battlesMissed));\n  })))), __jsx(_JSXStyle, {\n    id: \"1736245729\"\n  }, [\".table-responsive.jsx-1736245729{overflow-x:initial;}\", \".table.jsx-1736245729{width:100%;}\", \".table.jsx-1736245729 thead.jsx-1736245729{font-weight:bold;}\", \".table.jsx-1736245729 thead.jsx-1736245729 th.jsx-1736245729{cursor:pointer;position:-webkit-sticky;position:sticky;top:0;background:white;min-width:8rem;}\", \".table.jsx-1736245729 thead.jsx-1736245729 th.jsx-1736245729 span.jsx-1736245729{display:block;font-size:0.5rem;}\", \".table.jsx-1736245729 thead.jsx-1736245729 th.active.jsx-1736245729{color:blue;}\", \"table.jsx-1736245729 tbody.jsx-1736245729 td.jsx-1736245729:first-child.jsx-1736245729:not(.member){-webkit-text-decoration:line-through;text-decoration:line-through;font-weight:bold;background-color:grey !important;}\"]));\n};\n\nexport default WarPerformance;","map":null,"metadata":{},"sourceType":"module"}